[["disegni-d-ottimali.html", "Capitolo 5 Disegni D-ottimali 5.1 Algoritmo di Federov 5.2 Esempio: proprietà di un adesivo 5.3 Esempio: riparazione di una matrice", " Capitolo 5 Disegni D-ottimali Nelle sezioni precedenti sono stati illustrati disegni in cui la geometria del dominio sperimentale (iperpiano, ipercubo, ipersfera) e il modello erano prefissati (modello primo ordine, lineare senza interazioni, di secondo ordine lineare con interazioni di coppie di termini, di secondo ordine con interazioni a coppie e con termini quadratici). Questi piani sperimentali e i corrispondenti modelli sono ottimali e garantiscono la massima efficienza nella sperimentazione, vale a dire lottenimento della informazione di migliore qualità con il numero minimo di esperimenti possibile. Tuttavia esistono molte situazioni in cui i disegni fino ad ora visti possono non essere la scelta migliore. I casi più comuni in cui è difficile impiegare proficuamente i disegni canonici visti finora sono: la regione sperimentale non è una figura geometrica regolare: si devono rispettare condizioni di lavoro prestabilite - vincoli; il modello è non canonico: ad esempio contiene un termine quadratico in una variabile ma non nelle altre, oppure contiene fattori quantitativi e almeno un fattore qualitativo a più di due livelli (es. la regolazione di uno strumento è possibile solo su tre livelli non numerici indicati con basso, medio e alto) il numero di esperimenti fattibili non è sufficiente per completare i disegni fino ad ora visti per qualsiasi ragione (es. indisponibilità di risorse, di tempo) . In tutti questi casi, non è mai una buona decisione quella di adattare artificiosamente la sperimentazione ad un disegno sperimentale e ad un modello canonico. Piuttosto conviene pensare quali possono essere il modello e il piano sperimentale migliori per studiare il problema in osservazione. La soluzione a questi problemi che proponiamo in questo corso e nellapplicativo è fornita dai cosiddetti disegni D-ottimali. La costruzione dei disegni D-ottimali è condotta come segue. Fissata la regione sperimentale da stusiare, scegliamo in tale regione un insieme di \\(m\\) punti (leggi: esperimenti) candidati ad essere usati per costruire un disegno ad-hoc per il nostro problema. In generale si considera una griglia di punti che copre lintera regione da studiare con un dettaglio (leggi: ampiezza degli intervalli che costituiscono la griglia dei punti sperimentali) che dipende dagli obiettivi dello studio. Si scelgono quindi un modello contenente \\(p\\) parametri e il numero \\(n\\) \\[\\begin{equation*} p \\leq n \\leq m \\end{equation*}\\] di esperimenti che vogliamo eseguire. Fatte queste scelte la matematica ci consente di sapere che esistono \\[\\begin{equation*} \\frac{m!}{(m-n)!n!} \\end{equation*}\\] matrici sperimentali possibili. Per scegliere il disegno migliore tra queste \\(\\frac{m!}{(m-n)!n!}\\) matrici esistono vari criteri. In questa dispensa ci occuperemo del criterio cosiddetto di \\(D\\)-ottimalità e di quei disegni, definiti per questo D-ottimali, che soddisfano tale criterio di scelta. Tali disegni sono quelli che massimizzano il determinante della matrice di informazione. \\[\\begin{equation*} \\rm{det}(X^tX). \\end{equation*}\\] Maggiore è il determinante della matrice di informazione migliore è lortogonalità del modello. Si può dimostrare che la radice del determinate della matrice di informazione è inversamente proporzionale al volume delliperelissoide di confidenza dei parametri del modello. Massimizzare il determinante della matrice di informazione corrisponde a rendere di migliore qualità linformazione sui parametri del modello (i.e. rendere minima la loro varianza) e ottenere quindi la predizione più precisa della variabile risposta. I disegni canonici fino ad ora considerati sono tutti \\(D\\)-ottimali. Per poter confrontare disegni che differiscono per il numero di esperimenti progettati \\(n\\) (ad esempio, un disegno non canonico in cui è possibile avere più repliche di esperimenti nel dominio sperimentale) introduciamo il seguente indicatore \\(0 \\leq D \\leq 1\\) \\[\\begin{equation} D=\\frac{\\rm{det}(X^tX)^{1/p}}{n} \\tag{5.1} \\end{equation}\\] che misura la qualità del disegno considerato. Si noti che in generale per piani sperimentali multivariati non è vero che allaumentare di \\(n\\) abbiamo una migliore qualità del disegno (cf. Figura 5.3). Questo criterio vale solo per studi limitati alla misura delleffetto di un solo fattore. Lindicatore \\(D\\) trova il miglior compromesso tra maggiore informazione (determinante della matrice di informazione) e lo sforzo sperimentale (il numero \\(n\\) di esperimenti). Indicando rispettivamente con \\(D_1\\) e \\(D_2\\) lindicatore () per un piano sperimentale costruito con un disegno avente numero di esperimenti differenti \\(n_1\\) e \\(n_2\\), lefficacia relativa tra i due progetti si ottiene del rapporto \\(D_1/D_2\\). 5.1 Algoritmo di Federov Descriviamo brevemente lalgoritmo di Federov, su cui è basato lapplicativo, per determinare disegni \\(D\\)-ottimali. Sia \\(X_n\\) la matrice del modello di un disegno di \\(n\\) esperimenti. Indichiamo con \\(X_{n+1}\\) la matrice del modello del disegno di \\(n+1\\) punti sperimentali ottenuta aggiungendo a \\(X_n\\) un nuovo punto \\(x^j\\). La corrispondente matrice di informazione è data \\[\\begin{equation*} X^t_{n+1}X_{n+1}=X^t_nX_n+(x^j*x^{jt}) \\end{equation*}\\] il cui determinante soddisfa \\[\\begin{equation*} \\rm{det}(X^t_{n+1}X_{n+1})=\\rm{det}(X^t_nX_n)(1+h(x^j)), \\end{equation*}\\] dove \\(h(x^j)=x^j(X^t_nX_n){-1}x^{jt}\\) è il valore Leverage di \\(x^j\\). In maniera analoga, indicando con \\(X_{n-1}\\) la matrice del modello del disegno di \\(n-1\\) punti sperimentali ottenuto rimuovendo da \\(X_n\\) un punto \\(x_i\\), la corrispondente matrice di informazione è data \\[\\begin{equation*} X^t_{n-1}X_{n-1}=X^t_nX_n+(x_i*x^t_i) \\end{equation*}\\] il cui determinante soddisfa \\[\\begin{equation*} \\rm{det}(X^t_{n-1}X_{n-1})=\\rm{det}(X^t_nX_n)(1-h(x_i)), \\end{equation*}\\] dove \\(h(x_i)=x_i(X^t_nX_n)^{-1}x^t_i\\) è il valore Leverage di \\(x_i\\). Nellalgoritmo di Federov lo scambio tra un punto sperimentale \\(x^j\\) appartenete allinsieme dei punti candidati e un punto \\(x_i\\) appartenente al disegno iniziale avviene simultaneamente ottenendo un nuovo disegno la cui matrice del modello \\(\\tilde{X}_n\\) ha la corrispondente matrice di informazione legata alla precedente da \\[\\begin{equation*} \\tilde{X_n}^t\\tilde{X_n}=X^t_{n}X_{n}-(x_i*x_i^t)+(x^j*x^{jt}) \\end{equation*}\\] il cui determinante soddisfa \\[\\begin{equation*} \\rm{det}(\\tilde{X_n}^t\\tilde{X_n})=\\rm{det}(X^t_{n}X_{n})(1+\\Delta(x_i,x^j)), \\end{equation*}\\] dove \\[\\begin{equation*} \\Delta(x_i,x^j)=h(x^j)-(h(x_i)h(x^j)-h(x_i,x^j)^2)-h(x_i) \\end{equation*}\\] con \\(h(x_i,x^j)=x_i^t(X^tX)x^j=x^j(X^tX)x_i.\\) Lalgoritmo di Federov sceglie casualmente \\(n\\) punti nellinsieme dei punti candidati, ne calcola la matrice del modello \\(X\\) e quindi determina il valore \\(\\Delta(x_i,x^j)\\) per ogni coppia di \\((x_i,x^j)\\) con \\(x_i\\) appartenente al disegno scelto casualmente e \\(x^j\\) appartenente allinsieme dei punti candidati (esclusi gli \\(n\\) punti scelti). La procedura di calcolo individua una coppia di esperimenti \\((x_i,x^j)\\) per cui \\(\\Delta(x_i,x^j)\\) sia positivo e massimo e quindi scambia \\(x_i\\) con \\(x^j\\). A partire dal nuovo insieme di \\(n\\) punti ripete il procedimento finché non trova una coppia di punti \\((x_i,x^j)\\) con \\(\\Delta(x_i,x^j)&gt;0\\). Nei vari software di calcolo il procedimento si ferma quando \\(\\Delta(x_i,x^j)\\) raggiunge un valore sufficientemente piccolo. 5.2 Esempio: proprietà di un adesivo Uno sperimentatore sta indagando sulle proprietà di un particolare adesivo termoplastico. Ladesivo è applicato su due parti di pezzi che vengono incollati tra loro e quindi trattati a temperature diverse. I due fattori di interesse sono \\(X_1\\) la quantità di adesivo applicato \\(X_2\\) la temperatura. La variabile risposta \\(Y\\) è la forza con cui le due parti di ogni pezzo risultano incollate, misurata dalla cosiddetta forza di strappo. Questa risposta è descritta con un modello del secondo ordine \\[ Y=b_0+b_1X_1+b_2X_2+b_{11}X_1^2+b_{22}X_2^2+b_{12}X_1X_2 \\] Considerando il dominio standardizzato, le variabili \\(X_1\\) e \\(X_2\\) variano tra \\(-1\\) e \\(1\\). Lo sperimentatore sa che se viene applicato troppo poco adesivo e la temperatura è troppo bassa, le parti non si incollano. Si impone quindi il vincolo \\[ X_1+X_2\\geq-1.5 \\] Inoltre, se la temperatura del trattamento termico è troppo alta e si applica troppo adesivo, le parti incollate si rovinano per effetto di stress da calore, oppure non si incollano bene. Si impone quindi anche un secondo vincolo \\[ X_1+X_2\\leq 1 \\] Scegliamo nella regione sperimentale un insieme di punti candidati ad essere usati per un disegno. Stabiliamo ad esempio di usare una griglia di passo 0.1. Per generare la matrice dei punti candidati nellapplicativo, si seleziona il menù D-ottimale alla pagina Matrice punti candidati, e si scelgono le opzioni del caso in esame come in Figura 5.1 Figura 5.1: Costruzione della matrice dei punti candidati Si noti come sono stati indicati i vincoli. Se si vuole, è possibile scaricare la matrice dei punti candidati generata con il tasto Download. In Figura 5.2 è illustrata graficamente la forma del dominio sperimentale dei punti del caso in discussione, realizzata con Excel. Figura 5.2: Insieme dei punti candidati Nella pagina D-ottimale Figura 5.3 una volta fissato il modello e il numero massimo di esperimenti, cliccando sul bottone Calcola viene determinato il piano sperimentale D-ottimale per ogni numero di esperimenti tra il minimo e il massimo fissati nellapplicativo. Sono anche dati i valori del parametro \\(D\\) definito in (5.1) e il valore di VIF massimo. Possiamo vedere landamento di questi valori in funzione del numero di esperimenti in Figura 5.3 Figura 5.3: Andamento del parametro \\(D\\) e del VIF massimo in funzione del numero di esperimenti Come si può vedere in Figura 5.3 il migliore valore di \\(D\\) è dato dal piano con 7 esperimenti Figura 5.4 e Figura 5.5 Figura 5.4: Disegno D-ottimale Figura 5.5: Disegno D-ottimale 5.3 Esempio: riparazione di una matrice I disegni D-ottimali possono essere usati per riparare matrici i cui esperimenti sono stati eseguiti senza seguire un piano sperimentale predeterminato definendo linsieme degli esperimenti possibili (insieme dei punti candidati) e tenendo bloccati gli esperimenti già eseguiti. Vediamo un esempio. Per ottimizzare un metodo cromatografico (Leardi 2018) è stato utilizzato un CCD a facce centrate con 4 variabili e 5 repliche al centro per un totale di 29 esperimenti. Dopo che ci si è resi conto che il livello superiore di \\(X_3\\) era troppo alto (tutti i 9 esperimenti eseguiti con \\(X_3\\) = 1 sono falliti). Non era più possibile avere sufficiente informazione dai 16 esperimenti buoni di cui 1 replicato 5 volte (punti al centro). Fu deciso di tenere il precedente livello inferiore di \\(X_3\\) ma di utilizzare il livello centrale del primo piano di esperimenti come nuovo livello superiore e di fissare un nuovo livello centrale nel punto medio dei due nuovi livelli Tabella 5.1 Tabella 5.1: I 16 esperimenti buoni di cui 1 replicato 5 volte Exp. x1 x2 x3 x4 1 -1 -1 -1 -1 2 1 -1 -1 -1 3 -1 1 -1 -1 4 1 1 -1 -1 5 -1 -1 -1 1 6 1 -1 -1 1 7 -1 1 -1 1 8 1 1 -1 1 9 -1 0 1 0 10 1 0 1 0 11 0 -1 1 0 12 0 1 1 0 13 0 0 -1 0 14 0 0 1 -1 15 0 0 1 1 16 0 0 1 0 17 0 0 1 0 18 0 0 1 0 19 0 0 1 0 20 0 0 1 0 Gli esperimenti possibili tra cui scegliere i punti da introdurre nel piano sperimentale da aggiustare sono tutti i \\(3^4\\) esperimenti possibili con \\(4\\) fattori studiati a \\(3\\) livelli (-1,0,1), e da questi vanno tolti i 16 esperimenti già eseguiti. Per costruire linsieme di tutte le combinazioni dei 4 fattori con lapplicativo nella pagina Matrice punti candidati del menù D-ottimale si indicano i livelli per ogni variabile come in Figura 5.6 Figura 5.6: Costruzione dei punti candidati indicando i livelli Una volta ripulito il dataset creato dai 16 esperimenti già eseguiti lo si importa nella pagina Matrice punti candidati. Quindi si importano nella pagina D-ottimale per aggiunta i 16 esperimenti già eseguiti e, una volta fissati il numero minimo e massimo di esperimenti totali (20 già eseguiti: 16 più 5 repliche, quindi almeno 21), cliccando sul bottone Calcola si ottiene il piano sperimentale D-ottimale. Loperazione è condotta seguendo la stessa logica descritta per la pagina D-ottimale, Figura 5.7 Figura 5.7: Andamento del parametro \\(D\\) e VIF max in funzionedel Numero di esperimenti Nellesempio in discussione, il compromesso scelto fu quello di aggiungere 11 esperimenti ai 20 già eseguiti. La soluzione detta fu adottata considerando il basso costo di ogni esperimento. Come spesso accade però nelle analisi di esperimenti condotte a posteriori, se si riconsidera il problema più attentamente, si può osservare che aggiungendo un solo esperimento si ottiene una soluzione più che accettabile. Nota: lalgoritmo di Federov è conosciuto da oltre 40 anni ed è uno degli algoritmi più studiati per calcoli di disegni D-ottimali (Federov 1972). Negli anni, molti studiosi hanno sviluppato varianti di questo algoritmo presentate come più veloci ed efficienti, per cui usando sofware commerciali (es. Minitab, Design Expert, JMP) può capitare di dovere scegliere tra più opzioni di metodi per il calcolo di piani sperimentali ottimali. In questi software, lalgoritmo di Federov originale è chiamato algoritmo di scambio, e le versioni modificate fanno ricorso a sistemi meno laboriosi dal punto di vista del calcolo per la scelta dei punti su cui eseguire lo scambio descritto in questa sezione. Bibliografia "]]
